from flask import Flask, request, jsonify #flask version 2.0.1
import json
import mysql.connector #version 8.0.25
app = Flask(__name__)

#Create blog database.
def database():
    try:
        mydb = mysql.connector.connect(host='localhost',
                                   user='root',
                                   password='SU9887@',
                                   database= 'Private_deal')
        
        cur = mydb.cursor()
    except NameError as e:
        print(e)
    return mydb

#Create table for blogs.
def dbtable():
    mydb = database()
    btbl = ("""CREATE TABLE IF NOT EXISTS BLOGS(blog_id INT NOT NULL,
              blog_title VARCHAR(20) NOT NULL,
              blog_description MEDIUMTEXT NOT NULL)""")
    cur = mydb.cursor()
    cur.execute(btbl)
    mydb.commit()
    return btbl
    
#Create Blog.
@app.route('/Create_Blog', methods=['POST'])
def Create_blog():
    dbtable()
    mydb = database()
    cur = mydb.cursor()
    blog_id = request.form["blog_id"]
    blog_title = request.form["blog_title"]
    blog_description = request.form["blog_description"]
    ptabl_data = """INSERT INTO BLOGS(blog_id, blog_title, blog_description)
                    values(%s,%s,%s)"""
    cur.execute(ptabl_data, (blog_id, blog_title, blog_description))
    mydb.commit()
    return "<h2> Data Stored </h2>"
    
#Get Blog With Id.
@app.route('/Blog/<int:blog_id>', methods=['GET'])
def Blog_id(blog_id):
    mydb = database()
    r = None
    cur = mydb.cursor()
    b = "SELECT * FROM BLOGS WHERE blog_id=%s" %blog_id
    cur.execute(b)
    result = cur.fetchall()
    if result is not None:
        for res in result:
            r = dict(blog_id=res[0],blog_title=res[1],blog_description=res[2])
        return jsonify(r)
    else:
        return "No Data"

    
#To create new blog and  get all blog.... 
@app.route('/all_blogs', methods=['GET'])
def All_Blog():
    mydb = database()
    cur = mydb.cursor()
    all_blog = "Select * from BLOGS"
    cur.execute(all_blog)
    all_blogs = [dict(blog_id=row[0],
                 blog_title=row[1],
                 blog_description=row[2])
                 for row in cur.fetchall()
                ]
    mydb.commit()
    if all_blogs is not None:
        return jsonify(all_blogs)
    else:
        'No data Present in File.'

@app.route('/scrapy', methods=['GET'])
def scrapy():
    mydb = database()
    cur = mydb.cursor()
    area_name = []
    description = []
    scrap_data = "SELECT * FROM SCRAP_WIKI"
    cur.execute(scrap_data)
    data = cur.fetchall()
    sd=(len(data))
    print(sd)
    if data is not None:
        for a in data:
            area_name.append(a)
        return jsonify(dict(area_name))
    else:
        return "No data"

@app.route('/scrap',methods=['GET'])
def scrapdata():
    mydb = database()
    cur = mydb.cursor()
    area_name = request.args['area_name']  #pass a string parameter in double qoute.
    if 'area_name':
        scrap_data = ("SELECT * FROM SCRAP_WIKI WHERE area_name=%s" %area_name)
        cur.execute(scrap_data,area_name)
        data = cur.fetchone()
        mydb.commit()
        if data is not None:
            return jsonify(dict(area_name=data[0], description=data[1]))
        else:
            return "No data"
    else:
        return "Wrong Args."
    
    
if __name__== '__main__':
    app.run()
    
    

    
    







    
    

    


    







    
    

    






























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	
















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	
























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	

















































































    
    










    
    

    


    







    
    

    






























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	
















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	
























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	
















































































